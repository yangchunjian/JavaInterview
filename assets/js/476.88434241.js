(window.webpackJsonp=window.webpackJsonp||[]).push([[476],{1403:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"题目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#题目"}},[s._v("#")]),s._v(" 题目")]),s._v(" "),t("p",[s._v("部门表 Department：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[s._v('+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| id            | int     |\n| revenue       | int     |\n| month         | varchar |\n+---------------+---------+\n(id, month) 是表的联合主键。\n这个表格有关于每个部门每月收入的信息。\n月份（month）可以取下列值 ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]。\n')])])]),t("p"),s._v(" "),t("p",[s._v("编写一个 SQL 查询来重新格式化表，使得新的表中有一个部门 id 列和一些对应 每个月 的收入（revenue）列。")]),s._v(" "),t("p",[s._v("查询结果格式如下面的示例所示：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[s._v("Department 表：\n+------+---------+-------+\n| id   | revenue | month |\n+------+---------+-------+\n| 1    | 8000    | Jan   |\n| 2    | 9000    | Jan   |\n| 3    | 10000   | Feb   |\n| 1    | 7000    | Feb   |\n| 1    | 6000    | Mar   |\n+------+---------+-------+\n\n查询得到的结果表：\n+------+-------------+-------------+-------------+-----+-------------+\n| id   | Jan_Revenue | Feb_Revenue | Mar_Revenue | ... | Dec_Revenue |\n+------+-------------+-------------+-------------+-----+-------------+\n| 1    | 8000        | 7000        | 6000        | ... | null        |\n| 2    | 9000        | null        | null        | ... | null        |\n| 3    | null        | 10000       | null        | ... | null        |\n+------+-------------+-------------+-------------+-----+-------------+\n\n注意，结果表有 13 列 (1个部门 id 列 + 12个月份的收入列)。\n")])])]),t("h2",{attrs:{id:"思路"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#思路"}},[s._v("#")]),s._v(" 思路")]),s._v(" "),t("h2",{attrs:{id:"解法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解法"}},[s._v("#")]),s._v(" 解法")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("\n# "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Write")]),s._v(" your "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MySQL")]),s._v(" query statement below\n\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SELECT")]),s._v("\n    `id`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'Jan'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Jan_Revenue")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'Feb'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Feb_Revenue")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'Mar'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mar_Revenue")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'Apr'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Apr_Revenue")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'May'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("May_Revenue")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'Jun'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Jun_Revenue")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'Jul'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Jul_Revenue")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'Aug'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Aug_Revenue")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'Sep'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Sep_Revenue")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'Oct'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Oct_Revenue")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'Nov'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nov_Revenue")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SUM")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CASE")]),s._v(" `month` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WHEN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token char"}},[s._v("'Dec'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THEN")]),s._v(" `revenue` "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ELSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AS")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Dec_Revenue")]),s._v("`\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FROM")]),s._v("\n    `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Department")]),s._v("`\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GROUP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BY")]),s._v(" `id`\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("h2",{attrs:{id:"总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),t("ul",[t("li",[s._v("分析出几种情况，然后分别对各个情况实现")])])])}),[],!1,null,null,null);t.default=e.exports}}]);